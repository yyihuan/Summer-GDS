# Qt 阶段1：Python 启动入口说明

## 入口概览
- 新的启动方式：`uv run python -m web_gui.qt_launcher [参数]`。
- 入口负责解析命令行参数、读取可选的 JSON 配置文件，并生成统一的启动选项供后续 Qt 主窗口使用。
- 仍可暂时保留 `start_web_gui.sh` 作为兼容包装，但其功能已降级为提示信息，默认调用新的 Python 启动器。

## 支持的参数
| 参数 | 说明 |
| --- | --- |
| `--host=<host>` | 覆盖监听地址，默认 `0.0.0.0` |
| `--port=<port>` | 覆盖监听端口，默认 `5001` |
| `--debug` | 启用调试模式（若未指定则继承配置文件或默认值） |
| `--config=<file>` | 指定 JSON 配置文件（支持 `webgui_host/webgui_port/debug/auto_open_browser` 字段） |
| `--browser` | 强制在 Qt 中打开内嵌浏览器 |
| `--no-browser` | 禁止自动打开浏览器 |
| `--dry-run` | 打印解析结果后退出（用于测试阶段） |
| `--headless` | 预留的纯服务器模式开关（阶段4中完善） |

> `--browser` 与 `--no-browser` 为互斥选项，命令行优先级高于配置文件。

## 合并策略
1. 加载默认值：`host=0.0.0.0`、`port=5001`、`debug=False`、`open_browser=True`。
2. 如指定配置文件，读取并应用其中字段（若存在），未出现的字段保持默认。
3. 命令行参数优先生效，最终生成 `LaunchOptions` 数据对象（将在阶段2传递给 server/Qt 模块）。
4. `--dry-run` 模式下会输出解析后的完整选项，以便自动化测试与手工验证。

## 使用示例
```bash
# 查看默认解析结果
uv run python -m web_gui.qt_launcher --dry-run

# 指定配置文件，CLI 覆盖 host/port
tmp_json=$(mktemp)
cat > "$tmp_json" <<'JSON'
{"webgui_host": "192.168.9.9", "webgui_port": 6100, "debug": true, "auto_open_browser": false}
JSON
uv run python -m web_gui.qt_launcher --config "$tmp_json" --host=127.0.0.1 --dry-run

# 预留的 headless 调试（阶段4会接入实际逻辑）
uv run python -m web_gui.qt_launcher --headless --dry-run
```

## 后续步骤
- 阶段2将在此基础上实现 `ServerWorker` 与日志捕获，直接复用 `LaunchOptions`。
- 阶段3会将解析结果注入 Qt 主窗口，并在无 `--dry-run` 时真正启动 GUI。
- 文档与脚本将随着阶段演进持续更新。
